---
// @ts-nocheck
import Layout from '@/layouts/Layout.astro';

import Card from '@/components/Card.astro';
import SearchableGrid from '@/components/SearchableGrid.astro';

export async function getStaticPaths() {
    const DATA_URL = 'https://raw.githubusercontent.com/AutumnVN/StellaSoraData/refs/heads/main/arena.json';
    const data = await fetch(DATA_URL).then((res) => res.json());

    return Object.keys(data).map((groupId) => ({
        params: { groupId },
    }));
}

const DATA_URL = 'https://raw.githubusercontent.com/AutumnVN/StellaSoraData/refs/heads/main/arena.json';

const { params, request } = Astro;
const groupId = params.groupId;

const data = await fetch(DATA_URL).then((res) => res.json());
const group = data[groupId];

const emoji = {
    Aqua: 'ğŸ’§',
    Ignis: 'ğŸ”¥',
    Terra: 'â›°ï¸',
    Ventus: 'ğŸŒªï¸',
    Lux: 'â˜€ï¸',
    Umbra: 'ğŸŒ™',
    None: 'â¬œ',
};

if (!group) {
    throw Astro.redirect('/404');
}
---

<Layout title={`${group.name} | stelladb`} image={`https://stelladb.pages.dev/${group.icon}.avif`} description={`Weak: ${group.weakTo}${emoji[group.weakTo]}, ${group.openDayDesc}`}>
    <SearchableGrid placeholder={`Search ${group.name} difficulties by id, name, or element...`} noResultsText="No arena difficulty found.">
        {
            Object.entries(group.diff).map(([id, diff]) => (
                <div class="card-item" data-id={id} data-name={diff.name} data-weakto={diff.weakTo}>
                    <Card href={`/arena/${groupId}/${id}`} name={diff.name} desc={`Weak: ${group.weakTo}${emoji[group.weakTo]}`} image={`/${group.icon}.avif`} />
                </div>
            ))
        }
    </SearchableGrid>
</Layout>
